<!DOCTYPE html>
<head>
	<title>Friend Finder Survery</title>

	<!-- Compiled and minified CSS -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/css/materialize.min.css">

	<!-- style.css -->
	<link rel="stylesheet"  type="text/css" href="css/style.css">

</head>
<body>

	<div class="row">
		<div class="col s3"></div>
		<div class="col s7">
			<h1>Friend Finder Survey</h1>
		</div>
	</div>

	<div class="row">
		<div class="col s3"></div>
		<div class="col s6">
			<a id="home" href="/" class="waves-effect waves-light btn">Home</a>
		</div>
	</div>

	<div class="row">
	    <form class="col s12">
	      <div class="row">
	      	<div class="col s3"></div>
	        <div class="input-field col s6">
	          <input placeholder="John Smith" id="name" type="text" class="validate">
	          <label for="name">First Name</label>
	        </div>
	        <div class="col s3"></div>
	      </div>

	      <div class="row">
	      	<div class="col s3"></div>
	        <div class="input-field col s6">
	          <input placeholder="" id="image" type="text" class="validate">
	          <label for="image">Profile Image Link</label>
	        </div>
	        <div class="col s3"></div>
	      </div>


	      <div class="row">
			<div class="col s2"></div>
			<div class="col s8">
				<h6>On a scale of 1 (strongly dislike) to 5 (love), how much do you like:</h6>
			</div>
		  </div>

	     <!-- Questions -->
	      <div class="row">
	      	<div class="col s3"></div>
			<div class="input-field col s6">
				  <select id="Q1" class="question browser-default">
				    <option value="" disabled selected>Ice Cream</option>
				    <option value="1">1</option>
				    <option value="2">2</option>
				    <option value="3">3</option>
				    <option value="4">4</option>
				    <option value="5">5</option>
				  </select>
			</div>
			<div class="col s3"></div>
		  </div>

		  <div class="row">
	      	<div class="col s3"></div>
			<div class="input-field col s6">
				  <select id="Q2" class="question browser-default">
				    <option value="" disabled selected>The Color Blue</option>
				    <option value="1">1</option>
				    <option value="2">2</option>
				    <option value="3">3</option>
				    <option value="4">4</option>
				    <option value="5">5</option>
				  </select>
			</div>
			<div class="col s3"></div>
		  </div>

		  <div class="row">
	      	<div class="col s3"></div>
			<div class="input-field col s6">
				  <select id="Q3" class="question browser-default">
				    <option value="" disabled selected>Superheros</option>
				    <option value="1">1</option>
				    <option value="2">2</option>
				    <option value="3">3</option>
				    <option value="4">4</option>
				    <option value="5">5</option>
				  </select>
			</div>
			<div class="col s3"></div>
		  </div>

		  <div class="row">
	      	<div class="col s3"></div>
			<div class="input-field col s6">
				  <select id="Q4" class="question browser-default">
				    <option value="" disabled selected>Beer</option>
				    <option value="1">1</option>
				    <option value="2">2</option>
				    <option value="3">3</option>
				    <option value="4">4</option>
				    <option value="5">5</option>
				  </select>
			</div>
			<div class="col s3"></div>
		  </div>

		  <div class="row">
	      	<div class="col s3"></div>
			<div class="input-field col s6">
				  <select id="Q5" class="question browser-default">
				    <option value="" disabled selected>Amusement Parks</option>
				    <option value="1">1</option>
				    <option value="2">2</option>
				    <option value="3">3</option>
				    <option value="4">4</option>
				    <option value="5">5</option>
				  </select>
			</div>
			<div class="col s3"></div>
		  </div>

		  <div class="row">
	      	<div class="col s3"></div>
			<div class="input-field col s6">
				  <select id="Q6" class="question browser-default">
				    <option value="" disabled selected>The State Fair</option>
				    <option value="1">1</option>
				    <option value="2">2</option>
				    <option value="3">3</option>
				    <option value="4">4</option>
				    <option value="5">5</option>
				  </select>
			</div>
			<div class="col s3"></div>
		  </div>

		  <div class="row">
	      	<div class="col s3"></div>
			<div class="input-field col s6">
				  <select id="Q7" class="question browser-default">
				    <option value="" disabled selected>Kettle Corn</option>
				    <option value="1">1</option>
				    <option value="2">2</option>
				    <option value="3">3</option>
				    <option value="4">4</option>
				    <option value="5">5</option>
				  </select>
			</div>
			<div class="col s3"></div>
		  </div>

		  <div class="row">
	      	<div class="col s3"></div>
			<div class="input-field col s6">
				  <select id="Q8" class="question browser-default">
				    <option value="" disabled selected>Sleeping In Late</option>
				    <option value="1">1</option>
				    <option value="2">2</option>
				    <option value="3">3</option>
				    <option value="4">4</option>
				    <option value="5">5</option>
				  </select>
			</div>
			<div class="col s3"></div>
		  </div>

		  <div class="row">
	      	<div class="col s3"></div>
			<div class="input-field col s6">
				  <select id="Q9" class="question browser-default">
				    <option value="" disabled selected>Hot Chocolate On Rainy Days</option>
				    <option value="1">1</option>
				    <option value="2">2</option>
				    <option value="3">3</option>
				    <option value="4">4</option>
				    <option value="5">5</option>
				  </select>
			</div>
			<div class="col s3"></div>
		  </div>

		  <div class="row">
	      	<div class="col s3"></div>
			<div class="input-field col s6">
				  <select id="Q10" class="question browser-default">
				    <option value="" disabled selected>WIFI</option>
				    <option value="1">1</option>
				    <option value="2">2</option>
				    <option value="3">3</option>
				    <option value="4">4</option>
				    <option value="5">5</option>
				  </select>
			</div>
			<div class="col s3"></div>
		  </div>

		  <div class="row">
	      	<div class="col s5"></div>

	  		<div class="col s1">
  				<a id="submit" class="waves-effect waves-light btn modal-trigger" href="#modal1">Submit</a>
	  		</div>	
		  	<div class="col s6"></div>
		  </div>
	    </form>
	</div>

	<!-- Modal Structure -->
	<div id="modal1" class="modal modal-fixed-footer">
	    <div class="modal-content">
	      <h4 id=friendName>Ahmed</h4>
	      <img id="photo" src="https://media.licdn.com/mpr/mpr/shrinknp_400_400/p/6/005/064/1bd/3435aa3.jpg">
	    </div>
	    <div class="modal-footer">
	      <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat ">Close</a>
	    </div>
	</div>

<!--Import jQuery before materialize.js-->
<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>

<!-- Compiled and minified JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/js/materialize.min.js"></script>

<script>
	$(document).ready(function(){
	    $('.modal-trigger').leanModal();

		$('#submit').on('click', function() {
			//Gets an arrays total
			var arrayTotal = function (array) {
				var total = 0;
				for(i=0;i < array.length; i++) {
					total += parseInt(array[i]);
				}
				return total;
			};

			var total = [];
			var userTotal = arrayTotal(total);
			var name = $('#name').val().trim();
			var image = $('#image').val().trim();
			var a = total.push($('#Q1').val());
			var b = total.push($('#Q2').val());
			var c = total.push($('#Q3').val());
			var d = total.push($('#Q4').val());
			var e = total.push($('#Q5').val());
			var f = total.push($('#Q6').val());
			var g = total.push($('#Q7').val());
			var h = total.push($('#Q8').val());
			var i = total.push($('#Q9').val());
			var j = total.push($('#Q10').val());
			
			var userInfo = {
				name: name,
				photo: image,
				scores: total,
				total: userTotal
			};
		
			var currentURL = window.location.origin;

		    $.post(currentURL + "/api/friends", userInfo, function(data){
		    });

		    $.get(currentURL + "/view/all", function (data) {
				console.log(data);
				friends = data;

				var compatibilityArray = [];

				for (i=0; i < friends.length; i++) {
					var compTotal = friends[i].total - userTotal;
					if(compTotal < 0) {
						compTotal = compTotal * (-1);
					};
					compatibilityArray.push({
						name: friends[i].name,
						photo: friends[i].photo,
						compatibility: compTotal
					});
				};

				compatibilityArray.sort(function(a, b) {
				    return parseFloat(a.compatibility) - parseFloat(b.compatibility);
				});

				$('#friendName').html(compatibilityArray[1].name);
				$('#photo').attr('src', compatibilityArray[1].photo);
				$('#modal1').openModal();

				$('#name').val('');
				$('#image').val('');
				$('.question').val('');
			});
		});

	});
</script>
</body>
</html>